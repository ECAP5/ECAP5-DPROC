\section{Instruction Fetch Module}

\begin{figure}[h!]
    \centering
    \input{arch/figures/ifm-arch}
    \caption{Schematic view of the Instruction Fetch Module}
    \label{fig:ifm}
\end{figure}

\subsection{Interface}

\begin{content}
The instruction fetch module handles fetching from memory the instructions to be executing. The signals are described in table \ref{tab:ifm-interface}. 
\end{content}

\input{arch/tables/ifm-interface}

\subsection{Specification}

\subsubsection{Upstream requirements}

The table \ref{tab:ifm-upstream-requirements} outlines the upstream requirements applicable to the Instruction Fetch Module.

\input{arch/tables/ifm-upstream-requirements}

\subsubsection{Functional requirements}

\subsection{Behavior}

\begin{content}
  This module doesn't contain any prefetch mechanism as there is no performance requirement for version 1.0.0. This will lead to a performance bottleneck due to the number of cycles needed for fetching instructions from memory.
\end{content}

\subsubsection{Normal behavior}

\begin{content}
  During normal operation, the instruction fetch module sequentially emits memory requests to address stored in the \texttt{pc} register. Upon successful request, \texttt{pc} is incremented to point to the following instruction.

  This behavior induces a pipeline stall due to the delay of the wishbone interface.
\end{content}

\begin{figure}[H]
    \centering
    \input{arch/figures/ifm-behavior-normal.tex}
    \caption{Timing diagram of the normal behavior of the instruction fetch module}
    \label{fig:ifm-behavior-normal}
\end{figure}

\subsubsection{Reset behavior}

\begin{content}
  Once a reset occurs, \texttt{pc} is loaded with the boot address before returning to normal operation.

  This behavior doesn't induce any pipeline stall \textit{per se} as the pipeline is reset during this operation.
\end{content}

\begin{figure}[H]
    \centering
    \input{arch/figures/ifm-behavior-reset.tex}
    \caption{Timing diagram of the reset behavior of the instruction fetch module}
    \label{fig:ifm-behavior-reset}
\end{figure}

\subsubsection{Resource busy behavior}

\begin{content}
  The instruction fetch module is capable of handling wait states from memory through the stalling mechanism.
\end{content}

\begin{figure}[H]
    \centering
    \input{arch/figures/ifm-behavior-wait.tex}
    \caption{Timing diagram of the memory resource busy behavior of the instruction fetch module}
    \label{fig:ifm-behavior-wait}
\end{figure}

\subsubsection{Jump behavior}

\begin{content}
  TBC
\end{content}

\begin{figure}[H]
    \centering
    \input{arch/figures/ifm-behavior-jump-branch.tex}
    \caption{Timing diagram of the jump behavior of the instruction fetch module for branch events}
    \label{fig:ifm-behavior-branch}
\end{figure}

\begin{figure}[H]
    \centering
    \input{arch/figures/ifm-behavior-jump-interrupt.tex}
    \caption{Timing diagram of the jump behavior of the instruction fetch module for interrupt events}
    \label{fig:ifm-behavior-interrupt}
\end{figure}

\subsubsection{Hazard behaviors}

\begin{content}
  Hazard behaviors are described in section \ref{pipeline-stall}.
\end{content}

\newpage